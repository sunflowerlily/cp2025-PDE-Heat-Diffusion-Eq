# 项目3：量子隧穿效应数值模拟

## 项目概述

本项目使用Crank-Nicolson方法求解一维含时薛定谔方程，模拟电子波包穿越方势垒的量子隧穿现象。通过数值计算，学生将深入理解量子力学中的波包演化、隧穿效应和概率流密度等重要概念。

---

## 物理背景

### 含时薛定谔方程

一维含时薛定谔方程为：

$$i\hbar \frac{\partial \psi}{\partial t} = -\frac{\hbar^2}{2m} \frac{\partial^2 \psi}{\partial x^2} + V(x)\psi$$

其中：
- $\psi(x,t)$ 是波函数（复数）
- $\hbar$ 是约化普朗克常数
- $m$ 是电子质量
- $V(x)$ 是势能函数

### 方势垒模型

势能函数定义为：

$$V(x) = \begin{cases}
0 & x < x_1 \text{ 或 } x > x_2 \\
V_0 & x_1 \leq x \leq x_2
\end{cases}$$

其中 $V_0 = 0.18$ eV 是势垒高度。

### 初始波包

$t=0$ 时刻的高斯波包：

$$\psi(x,0) = \exp \left[ -\frac{(x-x_0)^2}{2\sigma^2} \right] e^{i \kappa x}$$

**物理参数：**
- $x_0 = L/2$ （波包初始位置）
- $\sigma = 1 \times 10^{-10}$ m （波包宽度）
- $\kappa = 5 \times 10^{10}$ m$^{-1}$ （初始动量对应的波数）
- $L$ = 计算区域长度
- $V_0 = 0.18$ eV （势垒高度）

---

## 学习目标

通过完成本项目，学生将能够：

1. **理解量子力学基本概念**
   - 波函数的物理意义和归一化条件
   - 概率密度和概率流密度的计算
   - 量子隧穿效应的物理机制

2. **掌握数值方法**
   - Crank-Nicolson隐式差分格式
   - 复数方程组的数值求解
   - 三对角矩阵算法的应用

3. **学会科学计算技能**
   - 复数数组的处理和可视化
   - 动画制作和时间演化分析
   - 物理量的数值计算和验证

4. **培养物理直觉**
   - 波包的色散和扩散现象
   - 隧穿概率与能量的关系
   - 量子力学的非经典行为

---

## 详细任务

### 任务1：Crank-Nicolson求解器实现 (30分)

**要求：**
1. 实现含时薛定谔方程的Crank-Nicolson离散化
2. 构建复数三对角矩阵系统
3. 求解线性方程组获得下一时刻波函数
4. 确保数值稳定性和精度

**关键技术点：**
- 复数差分格式的构造
- 边界条件的处理（吸收边界或周期边界）
- 三对角矩阵的LU分解
- 时间步长的选择

### 任务2：波包演化可视化 (25分)

**要求：**
1. 计算并绘制概率密度 $|\psi(x,t)|^2$ 的时间演化
2. 制作波包运动的动画
3. 显示势垒位置和高度
4. 分析波包的形状变化和扩散

**可视化要求：**
- 实时概率密度分布图
- 波函数实部和虚部的演化
- 势能函数的叠加显示
- 清晰的坐标轴和物理单位

### 任务3：隧穿效应分析 (25分)

**要求：**
1. 计算透射系数和反射系数
2. 分析隧穿概率随时间的变化
3. 研究不同初始动能对隧穿的影响
4. 验证概率守恒定律

**分析内容：**
- 波包到达势垒前后的行为对比
- 隧穿部分和反射部分的分离
- 经典禁区内的波函数行为
- 能量本征值与隧穿概率的关系

### 任务4：概率流密度计算 (15分)

**要求：**
1. 计算概率流密度：$j(x,t) = \frac{\hbar}{2mi}[\psi^* \nabla \psi - \psi \nabla \psi^*]$
2. 验证连续性方程：$\frac{\partial |\psi|^2}{\partial t} + \frac{\partial j}{\partial x} = 0$
3. 分析流密度在势垒附近的行为
4. 计算净透射流和反射流

### 任务5：参数敏感性研究 (5分)

**要求：**
1. 研究势垒高度对隧穿概率的影响
2. 分析波包宽度对隧穿过程的影响
3. 探讨初始动量对隧穿效率的影响
4. 比较不同数值参数的计算精度

---

## 提示与资源

### 关键公式

**1. Crank-Nicolson离散化：**

$$\frac{\psi_j^{n+1} - \psi_j^n}{\Delta t} = \frac{i\hbar}{2m} \frac{1}{2} \left[ \frac{\psi_{j+1}^{n+1} - 2\psi_j^{n+1} + \psi_{j-1}^{n+1}}{(\Delta x)^2} + \frac{\psi_{j+1}^n - 2\psi_j^n + \psi_{j-1}^n}{(\Delta x)^2} \right] - \frac{i}{\hbar} \frac{V_j}{2}(\psi_j^{n+1} + \psi_j^n)$$

**2. 矩阵形式：**

$$(I + \frac{i\Delta t}{2\hbar}H)\psi^{n+1} = (I - \frac{i\Delta t}{2\hbar}H)\psi^n$$

其中 $H$ 是哈密顿算符的离散化矩阵。

**3. 概率流密度：**

$$j_j = \frac{\hbar}{4mi\Delta x}[(\psi_j^*)_{j+1} - (\psi_j^*)_{j-1}]\psi_j - \frac{\hbar}{4mi\Delta x}\psi_j^*[\psi_{j+1} - \psi_{j-1}]$$

**4. 透射系数：**

$$T = \frac{\int_{x_2}^{\infty} |\psi(x,t_{\text{final}})|^2 dx}{\int_{-\infty}^{\infty} |\psi(x,0)|^2 dx}$$

### 编程提示

**1. 复数数组处理：**
```python
# 使用numpy的复数类型
psi = np.zeros(nx, dtype=complex)
psi_real = np.real(psi)
psi_imag = np.imag(psi)
```

**2. 三对角矩阵求解：**
```python
from scipy.sparse import diags
from scipy.sparse.linalg import spsolve

# 构建三对角矩阵
diagonals = [lower_diag, main_diag, upper_diag]
offsets = [-1, 0, 1]
matrix = diags(diagonals, offsets, format='csc')
```

**3. 动画制作：**
```python
import matplotlib.animation as animation

def animate(frame):
    line.set_ydata(np.abs(psi[:, frame])**2)
    return line,

ani = animation.FuncAnimation(fig, animate, frames=nt, 
                            interval=50, blit=True)
```

**4. 边界条件：**
```python
# 吸收边界条件
psi[0] = 0
psi[-1] = 0

# 或者使用复数吸收势
V_absorb = -1j * V0_absorb * np.exp(-(x - x_boundary)**2 / sigma_absorb**2)
```

### 物理常数

```python
# 基本物理常数
hbar = 1.054571817e-34  # J⋅s
m_e = 9.1093837015e-31  # kg
eV = 1.602176634e-19    # J

# 原子单位制（推荐）
hbar_au = 1.0
m_au = 1.0
E_au = 27.211386245988  # eV (Hartree)
a_au = 5.29177210903e-11  # m (Bohr radius)
```

### 数值参数建议

```python
# 空间网格
L = 20e-10          # 计算区域长度 (m)
nx = 1000           # 空间网格点数
dx = L / (nx - 1)   # 空间步长

# 时间网格
t_final = 1e-15     # 总时间 (s)
nt = 2000           # 时间步数
dt = t_final / nt   # 时间步长

# 稳定性条件检查
stability_factor = hbar * dt / (2 * m_e * dx**2)
print(f"稳定性因子: {stability_factor:.6f}")
```

---

## 评分标准

### 代码实现 (70分)

- **Crank-Nicolson求解器 (30分)**
  - 正确的离散化公式 (10分)
  - 复数矩阵构建 (10分)
  - 线性方程组求解 (10分)

- **可视化功能 (25分)**
  - 概率密度演化图 (10分)
  - 动画制作 (10分)
  - 图表质量和标注 (5分)

- **物理分析 (15分)**
  - 隧穿效应计算 (8分)
  - 概率流密度 (7分)

### 实验报告 (25分)

- **理论理解 (10分)**
  - 薛定谔方程物理意义
  - 隧穿效应机制解释

- **结果分析 (10分)**
  - 数值结果的物理解释
  - 参数影响的讨论

- **报告质量 (5分)**
  - 图表清晰度和完整性
  - 文字表达和逻辑性

### 创新加分 (5分)

- 实现变形Crank-Nicolson格式
- 多种边界条件的比较
- 二维或三维扩展
- 其他创新性分析

---

## 扩展思考

### 理论扩展

1. **经典极限**：如何从量子隧穿过渡到经典粒子运动？

2. **WKB近似**：如何用WKB方法估算隧穿概率？

3. **共振隧穿**：双势垒系统中的共振现象如何理解？

4. **时间延迟**：隧穿过程是否需要时间？如何定义隧穿时间？

### 应用拓展

1. **扫描隧道显微镜**：STM的工作原理与本项目的关系

2. **隧道二极管**：半导体器件中的隧穿效应

3. **核聚变**：恒星内部的量子隧穿过程

4. **量子计算**：量子比特的隧穿操控

### 数值方法扩展

1. **高阶格式**：四阶Runge-Kutta方法的应用

2. **自适应网格**：根据波函数梯度调整网格密度

3. **并行计算**：大规模量子系统的并行求解

4. **GPU加速**：使用CUDA或OpenCL加速计算

---

## 参考资料

### 教材章节
- 计算物理学教程 P338页程序及结果
- 量子力学教程中的隧穿效应章节
- 数值分析中的偏微分方程求解方法

### 推荐阅读
1. Griffiths, D. J. *Introduction to Quantum Mechanics*
2. Press, W. H. et al. *Numerical Recipes*
3. Tannor, D. J. *Introduction to Quantum Mechanics: A Time-Dependent Perspective*

### 在线资源
- NIST物理常数数据库
- SciPy稀疏矩阵文档
- Matplotlib动画教程

---

**项目完成时间建议：** 2-3周

**前置知识要求：**
- 量子力学基础
- 偏微分方程数值解
- Python科学计算
- 复数运算

**后续课程连接：**
- 多粒子量子系统
- 量子散射理论
- 固体物理计算