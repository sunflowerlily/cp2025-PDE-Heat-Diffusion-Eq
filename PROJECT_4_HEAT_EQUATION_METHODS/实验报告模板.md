# 项目：有限长细杆热传导方程多种数值方法比较 - 实验报告

**学生姓名：** [姓名] **学号：** [学号] **完成日期：** [日期]

## 1. 实验目的

通过实现和比较四种数值方法（显式差分法、隐式差分法、Crank-Nicolson方法、scipy.solve_ivp）求解一维热传导方程，深入理解不同数值格式的特点、稳定性和精度。

## 2. 问题描述

### 2.1 控制方程
一维热传导方程：
$$\frac{\partial u}{\partial t} = \alpha^2 \frac{\partial^2 u}{\partial x^2}$$

### 2.2 边界和初始条件
- **定义域**：$x \in [0, 20]$，$t \in [0, 25]$
- **边界条件**：$u(0,t) = u(20,t) = 0$
- **初始条件**：$u(x,0) = \begin{cases} 1 & \text{if } 10 \leq x \leq 11 \\ 0 & \text{elsewhere} \end{cases}$
- **物理参数**：$\alpha^2 = 10$

## 3. 数值方法实现

### 3.1 显式差分法 (FTCS)

**算法思路：**
使用前向时间差分和中心空间差分：
$$u_i^{n+1} = u_i^n + r(u_{i+1}^n - 2u_i^n + u_{i-1}^n)$$
其中 $r = \frac{\alpha^2 \Delta t}{(\Delta x)^2}$

**稳定性条件：** $r \leq 0.5$

**关键代码片段：**
```python
# 插入你的FTCS核心实现代码
```

**优缺点分析：**
- 优点：[填写]
- 缺点：[填写]

### 3.2 隐式差分法 (后向欧拉)

**算法思路：**
使用后向时间差分，需要求解线性方程组：
$$(I - r A)u^{n+1} = u^n$$

**关键代码片段：**
```python
# 插入你的隐式方法核心实现代码
```

**优缺点分析：**
- 优点：[填写]
- 缺点：[填写]

### 3.3 Crank-Nicolson方法

**算法思路：**
隐式和显式方法的平均，具有二阶时间精度：
$$(I - \frac{r}{2}A)u^{n+1} = (I + \frac{r}{2}A)u^n$$

**关键代码片段：**
```python
# 插入你的Crank-Nicolson核心实现代码
```

**优缺点分析：**
- 优点：[填写]
- 缺点：[填写]

### 3.4 scipy.solve_ivp方法

**算法思路：**
将PDE转换为ODE系统，利用高级积分器求解：
$$\frac{du}{dt} = \alpha^2 A u$$

**关键代码片段：**
```python
# 插入你的scipy方法核心实现代码
```

**优缺点分析：**
- 优点：[填写]
- 缺点：[填写]

## 4. 实验结果

### 4.1 方法比较结果

**计算参数：** $n_x = 101$, $n_t = 1000$

| 方法 | 计算时间(s) | L2相对误差 | 最大误差 | 稳定性 |
|------|-------------|------------|----------|--------|
| FTCS | [填写] | [填写] | [填写] | [填写] |
| 后向欧拉 | [填写] | [填写] | [填写] | [填写] |
| Crank-Nicolson | [填写] | [填写] | [填写] | [填写] |
| scipy.solve_ivp | [填写] | [填写] | [填写] | [填写] |

### 4.2 关键观察结果

**温度分布演化：**
[描述不同时刻的温度分布特征]

**误差分析：**
[分析各方法的误差特性]

**效率比较：**
[比较计算效率]

### 4.3 收敛性研究

**网格细化结果：**

| $\Delta x$ | FTCS误差 | 后向欧拉误差 | Crank-Nicolson误差 |
|------------|----------|--------------|--------------------|
| [填写] | [填写] | [填写] | [填写] |
| [填写] | [填写] | [填写] | [填写] |
| [填写] | [填写] | [填写] | [填写] |

**收敛阶数：**
- FTCS: [填写]
- 后向欧拉: [填写]
- Crank-Nicolson: [填写]

## 5. 问题与解决

### 5.1 主要困难

1. **稳定性问题：**
   [描述遇到的稳定性问题及解决方法]

2. **矩阵构建：**
   [描述稀疏矩阵构建的挑战]

3. **边界条件处理：**
   [描述边界条件实现的难点]

### 5.2 解决方法

[详细描述解决上述问题的方法和思路]

## 6. 结果分析与讨论

### 6.1 精度比较

[分析各方法的精度特性，解释为什么某些方法更精确]

### 6.2 效率分析

[分析计算效率，讨论精度与效率的权衡]

### 6.3 稳定性分析

[讨论各方法的稳定性特点，特别是FTCS的稳定性限制]

### 6.4 适用性讨论

[讨论在什么情况下应该选择哪种方法]

## 7. 主要收获

### 7.1 理论收获

1. **数值方法理解：** [总结对不同数值格式的理解]
2. **稳定性概念：** [总结对数值稳定性的认识]
3. **精度分析：** [总结对数值精度的理解]

### 7.2 编程技能

1. **稀疏矩阵操作：** [总结scipy.sparse的使用经验]
2. **ODE求解器：** [总结scipy.solve_ivp的使用体会]
3. **数据可视化：** [总结matplotlib的使用技巧]

### 7.3 科学计算思维

[总结在解决数值计算问题时的思维方法]

## 8. 思考题

### 8.1 理论思考

1. **为什么Crank-Nicolson方法具有二阶时间精度？**
   [你的回答]

2. **如何从理论上分析FTCS方法的稳定性条件？**
   [你的回答]

3. **隐式方法为什么无条件稳定？**
   [你的回答]

### 8.2 扩展思考

1. **如何将这些方法扩展到二维热传导方程？**
   [你的思考]

2. **对于非线性热传导方程，这些方法需要如何修改？**
   [你的思考]

3. **在实际工程应用中，如何选择合适的数值方法？**
   [你的思考]

## 9. 参考文献

1. [列出你参考的教材、论文或网络资源]
2. [包括具体的章节或页码]

---

**报告要求：**
- 总字数：1500-2500字
- 必须包含关键代码片段和数值结果
- 图表清晰，分析深入
- 思考题回答体现个人理解

**评分权重：**
- 方法实现与结果 (40%)
- 分析讨论质量 (35%)
- 问题解决过程 (15%)
- 思考题回答 (10%)