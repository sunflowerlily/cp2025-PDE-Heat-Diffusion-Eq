# 项目：热传导方程多种数值方法比较 - 实验报告

**学生姓名：** [姓名] **学号：** [学号] **完成日期：** [日期]

## 1. 实验目的

通过实现6种不同的数值方法求解一维热传导方程，深入理解各种数值格式的特点、稳定性和精度，掌握偏微分方程的数值求解技术。

## 2. 物理问题与数学模型

### 2.1 物理背景

[简述热传导物理过程，2-3句话]

### 2.2 数学模型

热传导方程：
$$
\frac{\partial u}{\partial t} = a^2 \frac{\partial^2 u}{\partial x^2}
$$

边界条件：$u(0, t) = 0$, $u(L, t) = 0$

初始条件：$u(x, 0) = \begin{cases} 1 & 10 \leq x \leq 11 \\ 0 & \text{其他} \end{cases}$

参数设置：$L = 20$, $T = 25$, $a^2 = 10$

## 3. 数值方法实现

### 3.1 网格设置

- 空间网格点数：$n_x = $ [填入值]
- 时间步数：$n_t = $ [填入值]
- 空间步长：$\Delta x = $ [填入值]
- 时间步长：$\Delta t = $ [填入值]
- 稳定性参数：$r = \frac{a^2 \Delta t}{(\Delta x)^2} = $ [填入值]

### 3.2 各方法核心算法

#### 3.2.1 FTCS显式方法

**离散格式：**
$$u_i^{n+1} = u_i^n + r(u_{i+1}^n - 2u_i^n + u_{i-1}^n)$$

**关键代码片段：**
```python
# 核心循环代码（5-8行）
for n in range(nt):
    for i in range(1, nx-1):
        u[n+1, i] = u[n, i] + r * (u[n, i+1] - 2*u[n, i] + u[n, i-1])
    u[n+1, 0] = 0   # 边界条件
    u[n+1, -1] = 0
```

**稳定性分析：** [分析r的限制条件]

#### 3.2.2 BTCS隐式方法

**离散格式：**
$$u_i^{n+1} - r(u_{i+1}^{n+1} - 2u_i^{n+1} + u_{i-1}^{n+1}) = u_i^n$$

**关键代码片段：**
```python
# 构建三对角矩阵求解线性方程组
main_diag = np.ones(nx) * (1 + 2*r)
upper_diag = np.ones(nx-1) * (-r)
lower_diag = np.ones(nx-1) * (-r)
# 使用solve_banded求解
```

#### 3.2.3 Crank-Nicolson方法

**离散格式：**
$$(I + \frac{r}{2}L)u^{n+1} = (I - \frac{r}{2}L)u^n$$

**优点：** [说明二阶精度和无条件稳定性]

#### 3.2.4 其他方法

[简要描述Laplace算符方法、变形CN方法和solve_ivp方法的特点]

## 4. 实验结果

### 4.1 数值解可视化

[插入温度分布随时间演化的图像]

### 4.2 方法比较结果

| 方法名称 | L2误差 | 最大误差 | 计算时间(s) | 备注 |
|---------|--------|----------|-------------|------|
| FTCS | [填入] | [填入] | [填入] | [稳定性] |
| Laplace显式 | [填入] | [填入] | [填入] | [特点] |
| BTCS | [填入] | [填入] | [填入] | [特点] |
| Crank-Nicolson | [填入] | [填入] | [填入] | [特点] |
| 变形CN | [填入] | [填入] | [填入] | [特点] |
| solve_ivp | [填入] | [填入] | [填入] | [特点] |

### 4.3 精度分析

**最精确方法：** [方法名称]

**最快方法：** [方法名称]

**最稳定方法：** [方法名称]

### 4.4 误差分析图

[插入误差比较柱状图]

## 5. 结果验证

### 5.1 与解析解比较

使用Fourier级数解析解验证数值结果：
$$u(x,t) = \sum_{n=1}^{\infty} b_n \sin\left(\frac{n\pi x}{L}\right) e^{-a^2(n\pi/L)^2 t}$$

**验证结果：** [说明数值解与解析解的吻合程度]

### 5.2 物理合理性检验

- **能量守恒：** [检查总热量随时间的变化]
- **边界条件：** [验证边界始终为0]
- **单调性：** [验证温度随时间单调递减]

## 6. 问题与收获

### 6.1 遇到的主要问题

1. **稳定性问题：** [描述显式方法的稳定性限制]
2. **矩阵求解：** [描述隐式方法中线性方程组求解的挑战]
3. **边界条件处理：** [描述边界条件实现的注意事项]

### 6.2 解决方法

1. **稳定性：** [说明如何选择合适的时间步长]
2. **矩阵求解：** [说明使用scipy.linalg.solve_banded的方法]
3. **边界条件：** [说明正确的边界条件实现方式]

### 6.3 主要收获

1. **数值方法理解：** 深入理解了显式、隐式和半隐式格式的区别和特点
2. **稳定性分析：** 掌握了数值稳定性的概念和CFL条件
3. **精度比较：** 学会了如何评估和比较不同数值方法的精度
4. **编程技能：** 提高了矩阵运算和科学计算的编程能力
5. **物理直觉：** 加深了对热传导过程的物理理解

## 7. 思考题

### 7.1 为什么显式方法有稳定性限制而隐式方法没有？

[从数值分析角度解释稳定性条件的来源]

### 7.2 在实际工程问题中，如何选择合适的数值方法？

[考虑精度、稳定性、计算效率等因素]

### 7.3 如何进一步提高计算精度？

[讨论网格加密、高阶格式等方法]

## 8. 扩展思考

### 8.1 二维热传导问题

[简述如何扩展到二维情况]

### 8.2 非线性热传导

[讨论温度相关的热传导系数]

### 8.3 实际应用

[列举热传导方程在工程中的应用实例]

## 9. 参考文献

1. [数值分析教材]
2. [偏微分方程数值解法]
3. [SciPy官方文档]

---

**报告总字数：** 约1200-1500字

**评分要点：**
- 方法实现正确性：40%
- 结果分析深度：30%
- 物理理解程度：20%
- 报告质量：10%