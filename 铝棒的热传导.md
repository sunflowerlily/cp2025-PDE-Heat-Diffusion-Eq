![绝热铝棒示意图](绝热铝棒示意图.png)

铝棒长度$L=1$m, 边界条件$T(x=0,t)=T(x=L,t)=0$K, 初条件$T(x,t=0)=100$ K. 热导率，比热容和密度分别为 $K=237\rm ~W/ mK$, $C=900\rm~ J/kg~K$,$\rho=2700\rm~ kg/m^3$.

1. 写出用差分法解热传导方程的程序，满足以上初、边界条件（参考《计算物理基础》332页的程序）

```python
K=237        #瓦/米/开尔文
C = 900      #焦耳/（公斤 开尔文),
rho = 2700   #公斤/立方米
D = K/C/rho  #扩散系数
L=1          #铝棒长度，单位: 米
dx = 0.01    #x方向步长单位: 米 L/(Nx-1)
dt = .5      #t方向步长单位：秒
r = D*dt/dx/dx
print(r) 
#%%
Nx = 101   #X方向的格点数
Nt = 2000    #t方向的格点数，代表数据长度Nt*dt
u = np.zeros((Nx,Nt))
u[0,:]  = 0    #左边界条件
u[-1,:] = 0    #右边界条件
u[:,0] = 100   #初始条件
for j in range(0,Nt-1):
    u[1:-1,j+1] = (1-2*r)*u[1:-1,j]+r*(u[2:,j]+u[:-2,j]) #迭代公式

fig = plt.figure()
x,y = np.mgrid[0:L:Nx*1j,0:Nt*dt:Nt*1j] #x,y坐标
ax = fig.add_subplot(111, projection='3d')
ax.plot_surface(x, y, u, cmap='rainbow')#,  rstride=3, cstride=10)
ax.set_xlabel("L (m)")
ax.set_ylabel("t (s)")
ax.set_zlabel("T (k)")

```

2. 比较解析解和数值解，画出3维温度分布图（类似下图）解析解为：
$T(x,t)=\sum\limits_{n=1,3,\cdots}^{\infty}\frac{4T_0}{n\pi}\sin k_nxe^{-k_n^2Kt/(C\rho)}.$
其中$k_n=n\pi/L$.

```python
#解析解
K=237
C = 900
rho = 2700
k0 = K/C/rho
def u(x,t,n=101,L=1):
    s = 0
    for i in range(n):
        j = 2*i+1
        s+=400/j/np.pi*np.sin(j*np.pi*x/L)\
        *np.exp(-(j*np.pi/L)**2*t*k0)
    return s
L1, L2 = 1, 1000
N1, N2 = 50, 400

x = np.linspace(0,L1,N1)
y = np.linspace(0,L2,N2)

X,Y = np.meshgrid(x,y)
U = u(X,Y,L=L1)
#from mpl_toolkits.mplot3d.axes3d import Axes3D     
fig = plt.figure()
ax1 = fig.add_subplot(111, projection='3d')
ax1.plot_surface(X,Y,U, cmap='rainbow', linewidth=0, antialiased=False) 
ax1.set_title('Analytical')  
```

3. 检查当$r>1/4$时，温度是否出现分叉现象？调整$\eta$, 查看何时解不稳定。
```python
K=237        #瓦/米/开尔文
C = 900      #焦耳/（公斤 开尔文),
rho = 2700   #公斤/立方米
D = K/C/rho  #扩散系数
L=1          #铝棒长度，单位: 米
dx = 0.01    #x方向步长单位: 米 L/(Nx-1)
dt = .25      #t方向步长单位：秒
r = D*dt/dx/dx #eta
print(r) 
#%%
Nx = 101   #X方向的格点数
Nt = 2000    #t方向的格点数，代表数据长度Nt*dt
u = np.zeros((Nx,Nt))
u[0,:]  = 0    #左边界条件
u[-1,:] = 0    #右边界条件
u[:,0] = 100   #初始条件
for j in range(0,Nt-1):
    u[1:-1,j+1] = (1-2*r)*u[1:-1,j]+r*(u[2:,j]+u[:-2,j]) #迭代公式

fig = plt.figure()
x,y = np.mgrid[0:L:Nx*1j,0:Nt*dt:Nt*1j] #x,y坐标
ax = fig.add_subplot(111, projection='3d')
ax.plot_surface(x, y, u, cmap='rainbow')#,  rstride=3, cstride=10)
ax.set_xlabel("L (m)")
ax.set_ylabel("t (s)")
ax.set_zlabel("T (k)")
```


4. 假设两个0.25m长的铝棒连接在一起，它们的另外两端放置在冰水中，一个铝棒温度为100 K，另外一个温度为50K, 查看温度随位置和时间的变化。

```python
K=237  #瓦/米/开尔文
C = 900   #焦耳/（公斤 开尔文),
rho = 2700  #公斤/立方米
eta = K/C/rho  #系数
L=1
dx = 0.01
dt = 0.5
r = eta*dt/dx/dx
print(r)
#%%
Nx = 101   #X方向的格点数
Nt = 1000    #t方向的格点数
u = np.zeros((Nx,Nt))
u[:51,0] = 100   #初始条件
u[50:,0] = 50   #初始条件
u[0,:]  = 0    #左边界条件
u[-1,:] = 0    #右边界条件
for j in range(0,Nt-1):
    u[1:-1,j+1] = (1-2*r)*u[1:-1,j]+r*(u[2:,j]+u[:-2,j])

fig = plt.figure()

x,y = np.mgrid[0:L:Nx*1j,0:Nt*0.5:Nt*1j]
ax = fig.add_subplot(111, projection='3d')
ax.plot_wireframe(x, y, u, rstride=5, cstride=30)
levels = np.linspace(u.min(),u.max(),10)
ax.contour(x,y,u,zdir='z',offset=u.min(),levels = levels,linewidths=1,linestyles='dashed')
ax.set_title('Laplace Iterate')
ax.set_xlabel("L (m)")
ax.set_ylabel("t (s)")
ax.set_zlabel("T (k)")
```

### 5.

根据牛顿冷却定律，如果铝棒不是在绝热体中，而是处于温度为$T_e$的环境中，因为辐射产生的温度变化为

$$
\frac{\partial T}{\partial t}=−h(T−T_e),
$$

这里h是正常数。这时热传导方程化为：

$$
\frac{\partial T(x,t)}{\partial t}=\frac{K}{C\rho}\frac{\partial^2 T(x,t)}{\partial x^2}-hT(x,t).
$$

修改程序，计算包含牛顿冷却的热传导方程，并与绝热体中的铝棒比较。(参考《计算物理基础》334页，非齐次方程数值解的程序)

```python
K=237  #瓦/米/开尔文
C = 900   #焦耳/（公斤 开尔文),
rho = 2700  #公斤/立方米
eta = K/C/rho  #系数
L=1
dx = 0.01
dt = 0.5
r = eta*dt/dx/dx
print(r)
h = 0.1   #牛顿冷却项的系数
#%%
Nx = 101   #X方向的格点数
Nt = 100    #t方向的格点数
u = np.zeros((Nx,Nt))
u[:,0] = 100   #初始条件
u[0,:]  = 0    #左边界条件
u[-1,:] = 0    #右边界条件
for j in range(0,Nt-1):
    u[1:-1,j+1] = (1-2*r-h*dt)*u[1:-1,j]+r*(u[2:,j]+u[:-2,j])

fig = plt.figure()

x,y = np.mgrid[0:L:Nx*1j,0:Nt*0.5:Nt*1j]
ax = fig.add_subplot(111, projection='3d')
ax.plot_wireframe(x, y, u, rstride=3, cstride=10)
ax.set_xlabel("L (m)")
ax.set_ylabel("t (s)")
ax.set_zlabel("T (k)")
```